
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>perform</title><meta name="generator" content="MATLAB 8.1"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2015-09-21"><meta name="DC.source" content="perform.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><pre class="codeinput">clear <span class="string">all</span>
<span class="comment">%start {God's name}:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span>
fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);
<span class="comment">%'+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++')</span>
fprintf(<span class="string">'+++++++++++++++++++++++++In the name of God+++++++++++++++++++++++++++'</span>);
<span class="comment">%'+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++')</span>

fprintf(<span class="string">'\n'</span>);

fprintf(<span class="string">'   This Program Performs: "FUZZY ENVIRONMENTAL RISK ASSESSMENT FERA"'</span>);
fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);


fprintf(<span class="string">' USER GUIDE:   This prgram comprises 3 parts: '</span>);
fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);

fprintf(<span class="string">'1)Input Data, 2) Fuzzy Assessment, 3)Output Presentation.'</span>);
fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);

fprintf(<span class="string">' The FERA processes 2 Fields: Air and Wastewater  '</span>);
fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);

fprintf(<span class="string">' The Field: Air Processes Concentrations of Pollutants:'</span>);
fprintf(<span class="string">'\n'</span>);

fprintf(<span class="string">' CO, NO2, SO2, PM2.5, O3, H2S, Benzene, Toluene, Xylene and Ethyl Benzene. '</span>);
fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);

fprintf(<span class="string">' The Field: Watewater Processes Concentrations of Pollutants: COD, BOD, TSS and pH  '</span>);
fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);

fid1=fopen(<span class="string">'data.docs'</span>,<span class="string">'w'</span>);
fprintf(fid1,<span class="string">'++++++++++++++++++++++++++++++Criteria AQI+++++++++++++++++++++++++++\n\n'</span>);

<span class="comment">%</span>
AQI=readfis(<span class="string">'AQI'</span>);
plotfis(AQI);
fprintf(fid1,<span class="string">'Figure 1 represents the Criteria Air Quality Index FIS  \n\n'</span>);
<span class="comment">%</span>

CO=xlsread(<span class="string">'data'</span>,<span class="string">'air-criteria'</span>,<span class="string">'B2'</span>);

NO2=xlsread(<span class="string">'data'</span>,<span class="string">'air-criteria'</span>,<span class="string">'C2'</span>);

SO2=xlsread(<span class="string">'data'</span>,<span class="string">'air-criteria'</span>,<span class="string">'D2'</span>);

O3=xlsread(<span class="string">'data'</span>,<span class="string">'air-criteria'</span>,<span class="string">'E2'</span>);

PM=xlsread(<span class="string">'data'</span>,<span class="string">'air-criteria'</span>,<span class="string">'F2'</span>);

outAQI=evalfis([CO NO2 SO2 O3 PM], AQI);

fprintf(<span class="string">'The Calculated Fuzzy Criteria AQI =  \n'</span>);
disp(outAQI);


fprintf(fid1,<span class="string">'The Calculated Fuzzy Criteria AQI =  \n\n'</span>);
fprintf(fid1,<span class="string">'%8.2f \n\n'</span>,outAQI);
fprintf(fid1,<span class="string">'Figure 2 illustrates the Membership Functions in Criteria AQI  \n\n'</span>);


figure;
plotmf(AQI, <span class="string">'output'</span>,1);


<span class="comment">%Start of LOOP For: Total Criteria AQI Fuzzy LEVEL</span>
<span class="comment">%Analysis&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>
disp(<span class="string">' '</span>);
<span class="keyword">if</span> (0&lt;=outAQI)&amp;&amp;(outAQI&lt;=50)
    fprintf(fid1,<span class="string">'Total level of Criteria AQI in Zone is:  \n'</span>);
    fprintf(fid1,<span class="string">'GOOD \n\n'</span>);
    sheet=1;
xlRange=<span class="string">'K2'</span>;
A={<span class="string">'GOOD'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

sheet=1;
xlRange=<span class="string">'M7'</span>;
A={<span class="string">'*'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);
        disp(<span class="string">'NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:'</span>);

<span class="keyword">else</span> <span class="keyword">if</span> (50&lt;outAQI)&amp;&amp;(outAQI&lt;=100)
       fprintf(fid1,<span class="string">'Total level of Criteria AQI in Zone is: \n\n'</span>);
       fprintf(fid1,<span class="string">'MODERATE \n\n'</span>);
            disp(<span class="string">'NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:'</span>);
            sheet=1;
xlRange=<span class="string">'K2'</span>;
A={<span class="string">'MODERATE'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

sheet=1;
xlRange=<span class="string">'M8'</span>;
A={<span class="string">'*'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);
    <span class="keyword">else</span> <span class="keyword">if</span> (100&lt;outAQI)&amp;&amp;(outAQI&lt;=150)
           fprintf(fid1,<span class="string">'Total level of Criteria AQI in Zone is:  \n\n'</span>);
            fprintf(fid1,<span class="string">'Unhealthy For Sensetive Group \n\n'</span>);
                disp(<span class="string">'NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:'</span>);
                sheet=1;
xlRange=<span class="string">'K2'</span>;
A={<span class="string">'SENSETIVE-UNHEALTHY'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

sheet=1;
xlRange=<span class="string">'M9'</span>;
A={<span class="string">'*'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

                <span class="keyword">else</span> <span class="keyword">if</span> (150&lt;outAQI)&amp;&amp;(outAQI&lt;=200)
            fprintf(fid1,<span class="string">'Total level of Criteria AQI in Zone is:  \n\n'</span>);
            fprintf(fid1,<span class="string">'Unhealthy \n\n'</span>);
                disp(<span class="string">'NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:'</span>);
                sheet=1;
xlRange=<span class="string">'K2'</span>;
A={<span class="string">'UNHEALTHY'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

sheet=1;
xlRange=<span class="string">'M10'</span>;
A={<span class="string">'*'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

                <span class="keyword">else</span> <span class="keyword">if</span> (200&lt;outAQI)&amp;&amp;(outAQI&lt;=300)
            fprintf(fid1,<span class="string">'Total level of Criteria AQI in Zone is:  \n\n'</span>);
            fprintf(fid1,<span class="string">'Very Unhealthy \n\n'</span>);
                disp(<span class="string">'NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:'</span>);
                sheet=1;
xlRange=<span class="string">'K2'</span>;
A={<span class="string">'VERY-UNHEALTHY'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

sheet=1;
xlRange=<span class="string">'M11'</span>;
A={<span class="string">'*'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

        <span class="keyword">else</span>
            fprintf(fid1,<span class="string">'Total level of Criteria AQI in Zone is:  \n\n'</span>);
           fprintf(fid1,<span class="string">'HAZARDOUS  \n\n'</span>);
                disp(<span class="string">'NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:'</span>);
                sheet=1;
xlRange=<span class="string">'K2'</span>;
A={<span class="string">'HAZARDOUS'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

sheet=1;
xlRange=<span class="string">'M12'</span>;
A={<span class="string">'*'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

                    <span class="keyword">end</span>;
                    <span class="keyword">end</span>;
        <span class="keyword">end</span>;
    <span class="keyword">end</span>;
<span class="keyword">end</span>;
disp(<span class="string">' '</span>);

<span class="comment">%End of LOOP For: Total Criteria AQI Fuzzy LEVEL</span>
<span class="comment">%Analysis:&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>


<span class="comment">%*******************************************************************************************</span>
<span class="comment">%Dominant Criteria AQI Pollutant Sellector</span>

CO1=CO/50;
NO21=NO2/2040;
SO21=SO2/1004;
O31=O3/600;
PM1=PM/500;
AQI1=[CO1, NO21, SO21, O31, PM1];
mainAQI=sort(AQI1);
disp(mainAQI);

[b, AQIIX]=max(AQI1);

<span class="keyword">if</span> AQIIX==1
     fprintf(fid1,<span class="string">'The Dominant Pollutant of Criteria AQI in Zone is:  \n\n'</span>);
    fprintf(fid1,<span class="string">'CO \n\n\n'</span>);

<span class="keyword">else</span> <span class="keyword">if</span> AQIIX==2
         fprintf(fid1,<span class="string">'The Dominant Pollutant of Criteria AQI in Zone is:  \n\n'</span>);
     fprintf(fid1,<span class="string">'NO2 \n\n\n'</span>);

    <span class="keyword">else</span> <span class="keyword">if</span> AQIIX==3
             fprintf(fid1,<span class="string">'The Dominant Pollutant of Criteria AQI in Zone is:  \n\n'</span>);
     fprintf(fid1,<span class="string">'SO2\n\n\n'</span>);

                <span class="keyword">else</span> <span class="keyword">if</span> AQIIX==4
            fprintf(fid1,<span class="string">'The Dominant Pollutant of Criteria AQI in Zone is:  \n\n'</span>);
     fprintf(fid1,<span class="string">'O3 \n\n\n'</span>);

                    <span class="keyword">else</span>
             fprintf(fid1,<span class="string">'The Dominant Pollutant of Criteria AQI in Zone is:  \n\n'</span>);
     fprintf(fid1,<span class="string">'PM2.5 \n\n\n'</span>);
                    <span class="keyword">end</span>;
        <span class="keyword">end</span>;
    <span class="keyword">end</span>;
<span class="keyword">end</span>;
<span class="comment">%End of Dominant criteria AQI Sellector</span>
<span class="comment">%*******************************************************************************************</span>


<span class="comment">%'+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++')</span>
fprintf(<span class="string">'++++++++++++++++++++++++++++++++++++BTEXHQI++++++++++++++++++++++++++++++++++++++++++'</span>);
<span class="comment">%'+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++')</span>

fprintf(fid1,<span class="string">'\n\n\n\n\n'</span>);

fprintf(fid1,<span class="string">'++++++++++++++++++++++++++++++BTEXHQI+++++++++++++++++++++++++++\n\n'</span>);

BTEXHQI=readfis(<span class="string">'BTEXHQI'</span>);
figure;
plotfis(BTEXHQI);

fprintf(fid1,<span class="string">'Figure 3 represents the BTEXH Air Quality Index FIS  \n\n'</span>);


H2S=xlsread(<span class="string">'data'</span>,<span class="string">'BTEXH'</span>,<span class="string">'B2'</span>);

Benzene=xlsread(<span class="string">'data'</span>,<span class="string">'BTEXH'</span>,<span class="string">'C2'</span>);

Toluene=xlsread(<span class="string">'data'</span>,<span class="string">'BTEXH'</span>,<span class="string">'D2'</span>);

EthylBenzene=xlsread(<span class="string">'data'</span>,<span class="string">'BTEXH'</span>,<span class="string">'E2'</span>);

Xylene=xlsread(<span class="string">'data'</span>,<span class="string">'BTEXH'</span>,<span class="string">'F2'</span>);

outBTEXHQI=evalfis([H2S Benzene Toluene EthylBenzene Xylene], BTEXHQI);
fprintf(<span class="string">'The Calculated Fuzzy BTEXHQI =  \n'</span>);
disp(outBTEXHQI);

figure;
plotmf(BTEXHQI, <span class="string">'output'</span>,1);


fprintf(fid1,<span class="string">'The Calculated Fuzzy BTEXHQI is =  \n\n'</span>);
fprintf(fid1,<span class="string">'%8.2f \n\n'</span>,outBTEXHQI);

fprintf(fid1,<span class="string">'Figure 4 illustrates the Membership Functions in BTEXHQI \n\n'</span>);


<span class="comment">%Start of LOOP For: Total BTEXHQI Fuzzy LEVEL</span>
<span class="comment">%Analysis&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>
disp(<span class="string">' '</span>);
<span class="keyword">if</span> (0&lt;=outBTEXHQI)&amp;&amp;(outBTEXHQI&lt;=50)
    fprintf(fid1,<span class="string">'Total level of outBTEXHQI in Zone is:  \n\n'</span>);
    fprintf(fid1,<span class="string">'GOOD  \n\n\n'</span>);
        disp(<span class="string">'NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:'</span>);
sheet=2;
xlRange=<span class="string">'J2'</span>;
A={<span class="string">'GOOD'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

sheet=2;
xlRange=<span class="string">'M7'</span>;
A={<span class="string">'*'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

<span class="keyword">else</span> <span class="keyword">if</span> (50&lt;outBTEXHQI)&amp;&amp;(outBTEXHQI&lt;=100)
         fprintf(fid1,<span class="string">'Total level of outBTEXHQI in Zone is:  \n\n'</span>);
        fprintf(fid1,<span class="string">'MODERATE  \n\n\n'</span>);
            disp(<span class="string">'NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:'</span>);
            sheet=2;
xlRange=<span class="string">'J2'</span>;
A={<span class="string">'MODERATE'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

sheet=2;
xlRange=<span class="string">'M8'</span>;
A={<span class="string">'*'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);


    <span class="keyword">else</span> <span class="keyword">if</span> (100&lt;outBTEXHQI)&amp;&amp;(outBTEXHQI&lt;=150)
           fprintf(fid1,<span class="string">'Total level of outBTEXHQI in Zone is:  \n\n'</span>);
            fprintf(fid1,<span class="string">'Unhealthy For Sensetive Group  \n\n\n'</span>);
                disp(<span class="string">'NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:'</span>);
                sheet=2;
xlRange=<span class="string">'J2'</span>;
A={<span class="string">'SENSETIVE-UNHEALTHY'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

sheet=2;
xlRange=<span class="string">'M9'</span>;
A={<span class="string">'*'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);


                <span class="keyword">else</span> <span class="keyword">if</span> (150&lt;outBTEXHQI)&amp;&amp;(outBTEXHQI&lt;=200)
            fprintf(fid1,<span class="string">'Total level of outBTEXHQI in Zone is:  \n\n'</span>);
             fprintf(fid1,<span class="string">'Unhealthy  \n\n\n'</span>);
                disp(<span class="string">'NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:'</span>);
                sheet=2;
xlRange=<span class="string">'J2'</span>;
A={<span class="string">'UNHEALTHY'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);


sheet=2;
xlRange=<span class="string">'M10'</span>;
A={<span class="string">'*'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

                <span class="keyword">else</span> <span class="keyword">if</span> (200&lt;outBTEXHQI)&amp;&amp;(outBTEXHQI&lt;=300)
             fprintf(fid1,<span class="string">'Total level of outBTEXHQI in Zone is:  \n\n'</span>);
            fprintf(fid1,<span class="string">'Very Unhealthy \n\n\n'</span>);
                disp(<span class="string">'NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:'</span>);
                sheet=2;
xlRange=<span class="string">'J2'</span>;
A={<span class="string">'VERY-UNHEALTHY'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

sheet=2;
xlRange=<span class="string">'M11'</span>;
A={<span class="string">'*'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);


        <span class="keyword">else</span>
            fprintf(fid1,<span class="string">'Total level of outBTEXHQI in Zone is:  \n\n'</span>);
            fprintf(fid1,<span class="string">'HAZARDOUS \n\n\n'</span>);
                disp(<span class="string">'NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:'</span>);
                sheet=2;
xlRange=<span class="string">'J2'</span>;
A={<span class="string">'HAZARDOUS'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

sheet=2;
xlRange=<span class="string">'M12'</span>;
A={<span class="string">'*'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);


                    <span class="keyword">end</span>;
                    <span class="keyword">end</span>;
        <span class="keyword">end</span>;
    <span class="keyword">end</span>;
<span class="keyword">end</span>;
disp(<span class="string">' '</span>);

<span class="comment">%End of LOOP For: Total BTEXHQI Fuzzy LEVEL</span>
<span class="comment">%Analysis:&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>


<span class="comment">% Dominant BTEXHQI Sellector</span>
<span class="comment">%*******************************************************************************************</span>
Benzene1=Benzene/50;
Toluene1=Toluene/7;
EthylBenzene1=EthylBenzene/30;
Xylene1=Xylene/100;
H2S1=H2S/1000;
BTEXHQI1=[Benzene1, Toluene1, EthylBenzene1, Xylene1, H2S1];

[c, BTEXHQIIX]=max(BTEXHQI1);

<span class="keyword">if</span> BTEXHQIIX==1
   fprintf(fid1,<span class="string">'The Dominant Pollutant of BTEXHQI in Zone is:  \n\n\n'</span>);
    fprintf(fid1,<span class="string">'Benzene'</span>);

<span class="keyword">else</span> <span class="keyword">if</span> BTEXHQIIX==2
       fprintf(fid1,<span class="string">'The Dominant Pollutant of BTEXHQI in Zone is:  \n\n\n'</span>);
    fprintf(fid1,<span class="string">'Toluene \n\n'</span>);

    <span class="keyword">else</span> <span class="keyword">if</span> BTEXHQIIX==3
            fprintf(fid1,<span class="string">'The Dominant Pollutant of BTEXHQI in Zone is:  \n\n\n'</span>);
    fprintf(fid1,<span class="string">'EthylBenzene \n\n'</span>);

                <span class="keyword">else</span> <span class="keyword">if</span> BTEXHQIIX==4
            fprintf(fid1,<span class="string">'The Dominant Pollutant of BTEXHQI in Zone is:  \n\n\n'</span>);
    fprintf(fid1,<span class="string">'Xylene \n\n'</span>);

                    <span class="keyword">else</span>
            fprintf(fid1,<span class="string">'The Dominant Pollutant of BTEXHQI in Zone is:  \n\n\n'</span>);
   fprintf(fid1,<span class="string">'H2S \n\n'</span>);
                    <span class="keyword">end</span>;
        <span class="keyword">end</span>;
    <span class="keyword">end</span>;
<span class="keyword">end</span>;
<span class="comment">%End of Dominant BTEXHQI Sellector</span>
<span class="comment">%*******************************************************************************************</span>

fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);
<span class="comment">%'+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++')</span>
fprintf(<span class="string">'++++++++++++++++++++++++++++++++++++FAQI++++++++++++++++++++++++++++++++++++++++++'</span>);
<span class="comment">%'+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++')</span>

fprintf(fid1,<span class="string">'\n\n\n\n\n'</span>);
fprintf(fid1,<span class="string">'++++++++++++++++++++++++++++++FAQI+++++++++++++++++++++++++++\n\n'</span>);


fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);


FAQI=readfis(<span class="string">'FAQI'</span>);
figure;
plotfis(FAQI);
fprintf(fid1,<span class="string">'Figure 5 represents the Fuzzy Air Quality Index FIS  \n\n'</span>);


outFAQI=evalfis([outAQI outBTEXHQI], FAQI);
fprintf(<span class="string">'The Calculated FAQI =  \n'</span>);
disp(outFAQI);

figure;
plotmf(FAQI, <span class="string">'output'</span>,1);

figure;
gensurf(FAQI);

fprintf(fid1,<span class="string">'The Calculated FAQI is=  \n\n'</span>);
fprintf(fid1,<span class="string">'%8.2f \n\n'</span>,outFAQI);

fprintf(fid1,<span class="string">'Figure 6 illustrates the Membership Functions in FAQI  \n\n'</span>);


<span class="comment">%Start of LOOP For: Total FAQI Fuzzy LEVEL</span>
<span class="comment">%Analysis&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>
disp(<span class="string">' '</span>);
<span class="keyword">if</span> (0&lt;=outFAQI)&amp;&amp;(outFAQI&lt;=50)
    fprintf(fid1,<span class="string">'Total level of outFAQI in Zone is:  \n\n'</span>);
    fprintf(fid1,<span class="string">'GOOD \n\n\n'</span>);
        disp(<span class="string">'NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:'</span>);
        sheet=4;
xlRange=<span class="string">'J2'</span>;
A={<span class="string">'GOOD'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

sheet=4;
xlRange=<span class="string">'M7'</span>;
A={<span class="string">'*'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);


<span class="keyword">else</span> <span class="keyword">if</span> (50&lt;outFAQI)&amp;&amp;(outFAQI&lt;=100)
        fprintf(fid1,<span class="string">'Total level of outFAQI in Zone is:  \n\n'</span>);
       fprintf(fid1,<span class="string">'MODERATE \n\n\n'</span>);
            disp(<span class="string">'NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:'</span>);
            sheet=4;
xlRange=<span class="string">'J2'</span>;
A={<span class="string">'MODERATE'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

sheet=4;
xlRange=<span class="string">'M8'</span>;
A={<span class="string">'*'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);


    <span class="keyword">else</span> <span class="keyword">if</span> (100&lt;outFAQI)&amp;&amp;(outFAQI&lt;=150)
            fprintf(fid1,<span class="string">'Total level of outFAQI in Zone is:  \n\n'</span>);
            fprintf(fid1,<span class="string">'Unhealthy For Sensetive Group \n\n\n'</span>);
                disp(<span class="string">'NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:'</span>);
                sheet=4;
xlRange=<span class="string">'J2'</span>;
A={<span class="string">'SENSETIVE-UNHEALTHY'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

sheet=4;
xlRange=<span class="string">'M9'</span>;
A={<span class="string">'*'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

                <span class="keyword">else</span> <span class="keyword">if</span> (150&lt;outFAQI)&amp;&amp;(outFAQI&lt;=200)
            fprintf(fid1,<span class="string">'Total level of outFAQI in Zone is:  \n\n'</span>);
           fprintf(fid1,<span class="string">'Unhealthy \n\n\n'</span>);
                disp(<span class="string">'NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:'</span>);
                sheet=4;
xlRange=<span class="string">'J2'</span>;
A={<span class="string">'UNHEALTHY'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

sheet=4;
xlRange=<span class="string">'M10'</span>;
A={<span class="string">'*'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);


                <span class="keyword">else</span> <span class="keyword">if</span> (200&lt;outFAQI)&amp;&amp;(outFAQI&lt;=300)
            fprintf(fid1,<span class="string">'Total level of outFAQI in Zone is:  \n\n'</span>);
            fprintf(fid1,<span class="string">'Very Unhealthy \n\n\n'</span>);
                disp(<span class="string">'NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:'</span>);
                sheet=4;
xlRange=<span class="string">'J2'</span>;
A={<span class="string">'VERY-UNHEALTHY'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

sheet=4;
xlRange=<span class="string">'M11'</span>;
A={<span class="string">'*'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);


        <span class="keyword">else</span>
            fprintf(fid1,<span class="string">'Total level of outFAQI in Zone is:  \n\n'</span>);
            fprintf(fid1,<span class="string">'HAZARDOUS  \n\n\n'</span>);
                disp(<span class="string">'NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:'</span>);
                sheet=4;
xlRange=<span class="string">'J2'</span>;
A={<span class="string">'HAZARDOUS'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

sheet=4;
xlRange=<span class="string">'M12'</span>;
A={<span class="string">'*'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);


                    <span class="keyword">end</span>;
                    <span class="keyword">end</span>;
        <span class="keyword">end</span>;
    <span class="keyword">end</span>;
<span class="keyword">end</span>;
disp(<span class="string">' '</span>);
<span class="comment">%End of LOOP For: Total FAQI Fuzzy LEVEL</span>
<span class="comment">%Analysis:&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>


fprintf(fid1,<span class="string">'Figure 7 represents the Surface Viewe of FAQI   \n\n'</span>);


<span class="comment">% Dominant FAQI Sellector</span>
<span class="comment">%*******************************************************************************************</span>
outAQI1=outAQI/500;
outBTEXHQI1=outBTEXHQI/500;
FAQI1=[outAQI1, outBTEXHQI1];

[d, FAQIIX]=max(FAQI1);

<span class="keyword">if</span> FAQIIX==1
   fprintf(fid1,<span class="string">'The Dominant Pollutant of FAQI in Zone is:  \n\n'</span>);
    fprintf(fid1,<span class="string">'AQI \n\n\n'</span>);
<span class="keyword">else</span>
        fprintf(fid1,<span class="string">'The Dominant Pollutant of FAQI in Zone is:  \n\n'</span>);
   fprintf(fid1,<span class="string">'BTEXHQI \n\n\n'</span>);
    <span class="keyword">end</span>;
<span class="comment">%End of Dominant FAQI Sellector</span>
<span class="comment">%*******************************************************************************************</span>


fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);
<span class="comment">%'+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++')</span>
fprintf(<span class="string">'++++++++++++++++++++++++++++++++++++FWWQI++++++++++++++++++++++++++++++++++++++++++'</span>);
<span class="comment">%'+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++')</span>
fprintf(fid1,<span class="string">'\n\n\n\n\n'</span>);

fprintf(fid1,<span class="string">'++++++++++++++++++++++++++++++FWWQI+++++++++++++++++++++++++++\n\n'</span>);

fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);

FWWQI=readfis(<span class="string">'WWQI'</span>);
figure;
plotfis(FWWQI);
fprintf(fid1,<span class="string">'Figure 8 represents the Fuzzy WateWater Quality Index FIS  \n\n'</span>);

fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);

COD=xlsread(<span class="string">'data'</span>,<span class="string">'wastewater'</span>,<span class="string">'B2'</span>);

BOD=xlsread(<span class="string">'data'</span>,<span class="string">'wastewater'</span>,<span class="string">'C2'</span>);

TSS=xlsread(<span class="string">'data'</span>,<span class="string">'wastewater'</span>,<span class="string">'D2'</span>);

pH=xlsread(<span class="string">'data'</span>,<span class="string">'wastewater'</span>,<span class="string">'E2'</span>);

PM=xlsread(<span class="string">'data'</span>,<span class="string">'wastewater'</span>,<span class="string">'F2'</span>);


outFWWQI=evalfis([TSS COD BOD pH], FWWQI);
fprintf(fid1,<span class="string">'The Calculated Fuzzy  WWQI =  \n\n'</span>);
fprintf(fid1,<span class="string">'%8.2f \n\n'</span>,outFWWQI);


figure;
plotmf(FWWQI, <span class="string">'output'</span>,1);
fprintf(fid1,<span class="string">'Figure 9 illustrates the Membership Functions in FWWQI \n\n'</span>);

<span class="comment">%Start of LOOP For: Total FWWQI Fuzzy LEVEL</span>
<span class="comment">%Analysis&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>
disp(<span class="string">' '</span>);
<span class="keyword">if</span> (0&lt;=outFWWQI)&amp;&amp;(outFWWQI&lt;=50)
    fprintf(fid1,<span class="string">'Total level of outFWWQI in Zone is:  \n\n'</span>);
     fprintf(fid1,<span class="string">'GOOD   \n\n\n'</span>);
        disp(<span class="string">'NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:'</span>);
        sheet=3;
xlRange=<span class="string">'J2'</span>;
A={<span class="string">'GOOD'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

sheet=3;
xlRange=<span class="string">'M7'</span>;
A={<span class="string">'*'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);


<span class="keyword">else</span> <span class="keyword">if</span> (50&lt;outFWWQI)&amp;&amp;(outFWWQI&lt;=100)
         fprintf(fid1,<span class="string">'Total level of outFWWQI in Zone is:  \n\n'</span>);
         fprintf(fid1,<span class="string">'MODERATE   \n\n\n'</span>);
            disp(<span class="string">'NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:'</span>);
            sheet=3;
xlRange=<span class="string">'J2'</span>;
A={<span class="string">'MODERATE'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

sheet=3;
xlRange=<span class="string">'M8'</span>;
A={<span class="string">'*'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);


                <span class="keyword">else</span> <span class="keyword">if</span> (100&lt;outFWWQI)&amp;&amp;(outFWWQI&lt;=200)
             fprintf(fid1,<span class="string">'Total level of outFWWQI in Zone is:  \n\n'</span>);
             fprintf(fid1,<span class="string">'LOW QUALITY   \n\n\n'</span>);
                disp(<span class="string">'NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:'</span>);
                sheet=3;
xlRange=<span class="string">'J2'</span>;
A={<span class="string">'LOW-QUALITY'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

sheet=3;
xlRange=<span class="string">'M9'</span>;
A={<span class="string">'*'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

                <span class="keyword">else</span> <span class="keyword">if</span> (200&lt;outFWWQI)&amp;&amp;(outFWWQI&lt;=300)
            fprintf(fid1,<span class="string">'Total level of outFWWQI in Zone is:  \n\n'</span>);
             fprintf(fid1,<span class="string">'Very LOW QUALITY \n\n\n'</span>);
                disp(<span class="string">'NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:'</span>);
                sheet=3;
xlRange=<span class="string">'J2'</span>;
A={<span class="string">'VERY-LOW-QUALITY'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

sheet=3;
xlRange=<span class="string">'M11'</span>;
A={<span class="string">'*'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

        <span class="keyword">else</span>
             fprintf(fid1,<span class="string">'Total level of outFWWQI in Zone is:  \n\n'</span>);
             fprintf(fid1,<span class="string">'HAZARDOUS QUALIY  \n\n\n'</span>);
                disp(<span class="string">'NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:'</span>);
                sheet=3;
xlRange=<span class="string">'J2'</span>;
A={<span class="string">'HAZARDOUS'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

sheet=3;
xlRange=<span class="string">'M12'</span>;
A={<span class="string">'*'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

                    <span class="keyword">end</span>;
                    <span class="keyword">end</span>;
    <span class="keyword">end</span>;
<span class="keyword">end</span>;
disp(<span class="string">' '</span>);

<span class="comment">%End of LOOP For: Total FWWQI Fuzzy LEVEL</span>
<span class="comment">%Analysis:&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>

<span class="comment">%*******************************************************************************************</span>
<span class="comment">%Dominant FWWQI Pollutant Sellector</span>

COD1=COD/300;
BOD1=BOD/150;
TSS1=TSS/200;

<span class="keyword">if</span> pH&gt;=7
    pH1=(pH-7)/7;
<span class="keyword">else</span> pH1=(7-pH)/7;
<span class="keyword">end</span>;

FWWQI1=[COD1, BOD1, TSS1, pH1];

[e, FWWQIIX]=max(FWWQI1);

<span class="keyword">if</span> FWWQIIX==1
   fprintf(fid1,<span class="string">'The Dominant Pollutant of FWWQI in Zone is:  \n\n'</span>);
    fprintf(fid1,<span class="string">'COD \n\n\n'</span>);

<span class="keyword">else</span> <span class="keyword">if</span> FWWQIIX==2
        fprintf(fid1,<span class="string">'The Dominant Pollutant of FWWQI in Zone is:  \n\n'</span>);
   fprintf(fid1,<span class="string">'BOD \n\n\n'</span>);

    <span class="keyword">else</span> <span class="keyword">if</span> FWWQIIX==3
            fprintf(fid1,<span class="string">'The Dominant Pollutant of FWWQI in Zone is:  \n\n'</span>);
    fprintf(fid1,<span class="string">'TSS \n\n\n'</span>);

                    <span class="keyword">else</span>
            fprintf(fid1,<span class="string">'The Dominant Pollutant of FWWQI in Zone is:  \n\n'</span>);
    fprintf(fid1,<span class="string">'pH \n\n\n'</span>);
        <span class="keyword">end</span>;
    <span class="keyword">end</span>;
<span class="keyword">end</span>;
<span class="comment">%End of Dominant FWWQI Sellector</span>
<span class="comment">%*******************************************************************************************</span>

fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">' ENVIRONMENTAL RISK = This Part Computes FUZZY ENVIRONMENTAL RISK ASSESSMENT '</span>);
fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);
<span class="comment">%'+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++')</span>
fprintf(<span class="string">'++++++++++++++++++++++++++++++++++++FERI++++++++++++++++++++++++++++++++++++++++++'</span>);
<span class="comment">%'+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++')</span>
fprintf(fid1,<span class="string">'\n\n\n\n\n'</span>);

fprintf(fid1,<span class="string">'++++++++++++++++++++++++++++++FERI+++++++++++++++++++++++++++\n\n'</span>);

fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);

FERI=readfis(<span class="string">'FERI'</span>);
figure;
plotfis(FERI);
fprintf(fid1,<span class="string">'Figure 10 represents the Fuzzy Environmental Risk Index FIS  \n\n'</span>);


fprintf(<span class="string">' FERI=  Data for Qualities: FAQI and FWWQI are processed via Fuzzy Environmental Risk Index '</span>);
fprintf(<span class="string">'\n'</span>);
fprintf(<span class="string">'\n'</span>);



outFERI=evalfis([outFAQI outFWWQI], FERI);
fprintf(fid1, <span class="string">'The Calculated FERI =  \n'</span>);
fprintf(fid1,<span class="string">'%8.2f \n\n'</span>,outFERI);


figure;
plotmf(FERI, <span class="string">'output'</span>,1);
fprintf(fid1,<span class="string">'Figure 11 illustrates the Membership Functions in FERI \n\n'</span>);


figure;
gensurf(FERI);


<span class="comment">%Start of LOOP For: Total outFERI Fuzzy LEVEL</span>
<span class="comment">%Analysis&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>
disp(<span class="string">' '</span>);
<span class="keyword">if</span> (0&lt;=outFERI)&amp;&amp;(outFERI&lt;=50)
    fprintf(fid1,<span class="string">'Total level of outFERI in Zone is:  \n\n'</span>);
    fprintf(fid1,<span class="string">'LOW RISK   \n\n\n'</span>);
        disp(<span class="string">'NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:'</span>);
        sheet=5;
xlRange=<span class="string">'J2'</span>;
A={<span class="string">'LOW-RISK'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

sheet=5;
xlRange=<span class="string">'M7'</span>;
A={<span class="string">'*'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

<span class="keyword">else</span> <span class="keyword">if</span> (50&lt;outFERI)&amp;&amp;(outFERI&lt;=100)
        fprintf(fid1,<span class="string">'Total level of outFERI in Zone is:  \n\n'</span>);
        fprintf(fid1,<span class="string">'MODERATE RISK   \n\n\n'</span>);
            disp(<span class="string">'NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:'</span>);
            sheet=5;
xlRange=<span class="string">'J2'</span>;
A={<span class="string">'MODERATE-RISK'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

sheet=5;
xlRange=<span class="string">'M8'</span>;
A={<span class="string">'*'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);


                <span class="keyword">else</span> <span class="keyword">if</span> (100&lt;outFERI)&amp;&amp;(outFERI&lt;=200)
            fprintf(fid1,<span class="string">'Total level of outFERI in Zone is:  \n\n'</span>);
            fprintf(fid1,<span class="string">'RELATIVELY HIGH RISK   \n\n\n'</span>);
                disp(<span class="string">'NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:'</span>);
                sheet=5;
xlRange=<span class="string">'J2'</span>;
A={<span class="string">'RELEATIVELY-HIGH-RISK'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

sheet=5;
xlRange=<span class="string">'M9'</span>;
A={<span class="string">'*'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

                <span class="keyword">else</span> <span class="keyword">if</span> (200&lt;outFERI)&amp;&amp;(outFERI&lt;=300)
            fprintf(fid1,<span class="string">'Total level of outFERI in Zone is:  \n\n'</span>);
            fprintf(fid1,<span class="string">'HIGH RISK \n\n\n'</span>);
                disp(<span class="string">'NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:'</span>);
                sheet=5;
xlRange=<span class="string">'J2'</span>;
A={<span class="string">'HIGH-RISK'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

sheet=5;
xlRange=<span class="string">'M11'</span>;
A={<span class="string">'*'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

        <span class="keyword">else</span>
            fprintf(fid1,<span class="string">'Total level of outFERI in Zone is:  \n\n'</span>);
            fprintf(fid1,<span class="string">'VERY HIGH RISK  \n\n\n'</span>);
                disp(<span class="string">'NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:'</span>);
                sheet=5;
xlRange=<span class="string">'J2'</span>;
A={<span class="string">'VERY-HIGH-RISK'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

sheet=5;
xlRange=<span class="string">'M12'</span>;
A={<span class="string">'*'</span>};
xlswrite(<span class="string">'data'</span>, A, sheet, xlRange);

                    <span class="keyword">end</span>;
                    <span class="keyword">end</span>;
    <span class="keyword">end</span>;
<span class="keyword">end</span>;
disp(<span class="string">' '</span>);

<span class="comment">%End of LOOP For: Total outFERI Fuzzy LEVEL</span>
<span class="comment">%Analysis:&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>




fprintf(fid1,<span class="string">'Figure 12 represents the Surface viewe of Fuzzy Environmental Risk Index \n\n'</span>);

<span class="comment">% Dominant FERI Sellector</span>
<span class="comment">%*******************************************************************************************</span>
outFAQI1=outFAQI/500;
outFWWQI1=outFWWQI/500;
FERI1=[outFAQI1, outFWWQI1];

[f, FERIIX]=max(FERI1);

<span class="keyword">if</span> FERIIX==1
    fprintf(fid1,<span class="string">'The Dominant Pollutant of FERI in Zone is:  \n\n'</span>);
   fprintf(fid1,<span class="string">'FAQI  \n\n\n'</span>);
<span class="keyword">else</span>
        fprintf(fid1,<span class="string">'The Dominant Pollutant of FERI in Zone is:  \n\n'</span>);
   fprintf(fid1,<span class="string">'FWWQI \n\n\n'</span>);
    <span class="keyword">end</span>;
<span class="comment">%End of Dominant FERI Sellector</span>
<span class="comment">%*******************************************************************************************</span>

sheet=1;
xlRange=<span class="string">'I2'</span>;
xlswrite(<span class="string">'data'</span>, outAQI, sheet, xlRange);
sheet=2;
xlRange=<span class="string">'I2'</span>;
xlswrite(<span class="string">'data'</span>,outBTEXHQI , sheet, xlRange);
sheet=3;
xlRange=<span class="string">'I2'</span>;
xlswrite(<span class="string">'data'</span>, outFWWQI, sheet, xlRange);
sheet=4;
xlRange=<span class="string">'I2'</span>;
xlswrite(<span class="string">'data'</span>, outFAQI, sheet, xlRange);
sheet=5;
xlRange=<span class="string">'I2'</span>;
xlswrite(<span class="string">'data'</span>, outFERI, sheet, xlRange);
</pre><pre class="codeoutput">

+++++++++++++++++++++++++In the name of God+++++++++++++++++++++++++++
   This Program Performs: "FUZZY ENVIRONMENTAL RISK ASSESSMENT FERA"

 USER GUIDE:   This prgram comprises 3 parts: 

1)Input Data, 2) Fuzzy Assessment, 3)Output Presentation.


 The FERA processes 2 Fields: Air and Wastewater  

 The Field: Air Processes Concentrations of Pollutants:
 CO, NO2, SO2, PM2.5, O3, H2S, Benzene, Toluene, Xylene and Ethyl Benzene. 

 The Field: Watewater Processes Concentrations of Pollutants: COD, BOD, TSS and pH  




The Calculated Fuzzy Criteria AQI =  
  141.7004

 
NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:
 
    0.0142    0.0180    0.0217    0.0480    0.4382

++++++++++++++++++++++++++++++++++++BTEXHQI++++++++++++++++++++++++++++++++++++++++++The Calculated Fuzzy BTEXHQI =  
  266.2003

 
NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:
 




++++++++++++++++++++++++++++++++++++FAQI++++++++++++++++++++++++++++++++++++++++++



The Calculated FAQI =  
  200.4942

 
NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:
 



++++++++++++++++++++++++++++++++++++FWWQI++++++++++++++++++++++++++++++++++++++++++





 
NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:
 




 ENVIRONMENTAL RISK = This Part Computes FUZZY ENVIRONMENTAL RISK ASSESSMENT 



++++++++++++++++++++++++++++++++++++FERI++++++++++++++++++++++++++++++++++++++++++



 FERI=  Data for Qualities: FAQI and FWWQI are processed via Fuzzy Environmental Risk Index 

 
NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:
 
</pre><img vspace="5" hspace="5" src="perform_01.png" alt=""> <img vspace="5" hspace="5" src="perform_02.png" alt=""> <img vspace="5" hspace="5" src="perform_03.png" alt=""> <img vspace="5" hspace="5" src="perform_04.png" alt=""> <img vspace="5" hspace="5" src="perform_05.png" alt=""> <img vspace="5" hspace="5" src="perform_06.png" alt=""> <img vspace="5" hspace="5" src="perform_07.png" alt=""> <img vspace="5" hspace="5" src="perform_08.png" alt=""> <img vspace="5" hspace="5" src="perform_09.png" alt=""> <img vspace="5" hspace="5" src="perform_10.png" alt=""> <img vspace="5" hspace="5" src="perform_11.png" alt=""> <img vspace="5" hspace="5" src="perform_12.png" alt=""> <p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2013a</a><br></p></div><!--
##### SOURCE BEGIN #####
clear all
%start {God's name}:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
fprintf('\n');
fprintf('\n');
%'+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++')
fprintf('+++++++++++++++++++++++++In the name of God+++++++++++++++++++++++++++');
%'+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++')

fprintf('\n');

fprintf('   This Program Performs: "FUZZY ENVIRONMENTAL RISK ASSESSMENT FERA"');
fprintf('\n');
fprintf('\n');


fprintf(' USER GUIDE:   This prgram comprises 3 parts: ');
fprintf('\n');
fprintf('\n');

fprintf('1)Input Data, 2) Fuzzy Assessment, 3)Output Presentation.');
fprintf('\n');
fprintf('\n');
fprintf('\n');

fprintf(' The FERA processes 2 Fields: Air and Wastewater  ');
fprintf('\n');
fprintf('\n');

fprintf(' The Field: Air Processes Concentrations of Pollutants:');
fprintf('\n');

fprintf(' CO, NO2, SO2, PM2.5, O3, H2S, Benzene, Toluene, Xylene and Ethyl Benzene. ');
fprintf('\n');
fprintf('\n');

fprintf(' The Field: Watewater Processes Concentrations of Pollutants: COD, BOD, TSS and pH  ');
fprintf('\n');
fprintf('\n');
fprintf('\n');
fprintf('\n');
fprintf('\n');

fid1=fopen('data.docs','w');
fprintf(fid1,'++++++++++++++++++++++++++++++Criteria AQI+++++++++++++++++++++++++++\n\n');

% 
AQI=readfis('AQI');
plotfis(AQI);
fprintf(fid1,'Figure 1 represents the Criteria Air Quality Index FIS  \n\n');
% 

CO=xlsread('data','air-criteria','B2');

NO2=xlsread('data','air-criteria','C2');

SO2=xlsread('data','air-criteria','D2');

O3=xlsread('data','air-criteria','E2');

PM=xlsread('data','air-criteria','F2');

outAQI=evalfis([CO NO2 SO2 O3 PM], AQI);

fprintf('The Calculated Fuzzy Criteria AQI =  \n');
disp(outAQI);


fprintf(fid1,'The Calculated Fuzzy Criteria AQI =  \n\n');
fprintf(fid1,'%8.2f \n\n',outAQI);
fprintf(fid1,'Figure 2 illustrates the Membership Functions in Criteria AQI  \n\n');


figure;
plotmf(AQI, 'output',1);


%Start of LOOP For: Total Criteria AQI Fuzzy LEVEL
%Analysis>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
disp(' ');
if (0<=outAQI)&&(outAQI<=50)
    fprintf(fid1,'Total level of Criteria AQI in Zone is:  \n');
    fprintf(fid1,'GOOD \n\n');
    sheet=1;
xlRange='K2';
A={'GOOD'};
xlswrite('data', A, sheet, xlRange);

sheet=1;
xlRange='M7';
A={'*'};
xlswrite('data', A, sheet, xlRange);
        disp('NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:');

else if (50<outAQI)&&(outAQI<=100)
       fprintf(fid1,'Total level of Criteria AQI in Zone is: \n\n');
       fprintf(fid1,'MODERATE \n\n');
            disp('NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:');
            sheet=1;
xlRange='K2';
A={'MODERATE'};
xlswrite('data', A, sheet, xlRange);

sheet=1;
xlRange='M8';
A={'*'};
xlswrite('data', A, sheet, xlRange);
    else if (100<outAQI)&&(outAQI<=150)
           fprintf(fid1,'Total level of Criteria AQI in Zone is:  \n\n');
            fprintf(fid1,'Unhealthy For Sensetive Group \n\n');
                disp('NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:');
                sheet=1;
xlRange='K2';
A={'SENSETIVE-UNHEALTHY'};
xlswrite('data', A, sheet, xlRange);

sheet=1;
xlRange='M9';
A={'*'};
xlswrite('data', A, sheet, xlRange);
                
                else if (150<outAQI)&&(outAQI<=200)
            fprintf(fid1,'Total level of Criteria AQI in Zone is:  \n\n');
            fprintf(fid1,'Unhealthy \n\n');
                disp('NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:');
                sheet=1;
xlRange='K2';
A={'UNHEALTHY'};
xlswrite('data', A, sheet, xlRange);
                
sheet=1;
xlRange='M10';
A={'*'};
xlswrite('data', A, sheet, xlRange);

                else if (200<outAQI)&&(outAQI<=300)
            fprintf(fid1,'Total level of Criteria AQI in Zone is:  \n\n');
            fprintf(fid1,'Very Unhealthy \n\n');
                disp('NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:');
                sheet=1;
xlRange='K2';
A={'VERY-UNHEALTHY'};
xlswrite('data', A, sheet, xlRange);

sheet=1;
xlRange='M11';
A={'*'};
xlswrite('data', A, sheet, xlRange);

        else
            fprintf(fid1,'Total level of Criteria AQI in Zone is:  \n\n');
           fprintf(fid1,'HAZARDOUS  \n\n');
                disp('NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:');
                sheet=1;
xlRange='K2';
A={'HAZARDOUS'};
xlswrite('data', A, sheet, xlRange);
                
sheet=1;
xlRange='M12';
A={'*'};
xlswrite('data', A, sheet, xlRange);

                    end;
                    end;
        end;
    end;
end;
disp(' ');

%End of LOOP For: Total Criteria AQI Fuzzy LEVEL
%Analysis:<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<


%*******************************************************************************************
%Dominant Criteria AQI Pollutant Sellector

CO1=CO/50;
NO21=NO2/2040;
SO21=SO2/1004;
O31=O3/600;
PM1=PM/500;
AQI1=[CO1, NO21, SO21, O31, PM1];
mainAQI=sort(AQI1);
disp(mainAQI);

[b, AQIIX]=max(AQI1);

if AQIIX==1
     fprintf(fid1,'The Dominant Pollutant of Criteria AQI in Zone is:  \n\n');
    fprintf(fid1,'CO \n\n\n');

else if AQIIX==2
         fprintf(fid1,'The Dominant Pollutant of Criteria AQI in Zone is:  \n\n');
     fprintf(fid1,'NO2 \n\n\n');
    
    else if AQIIX==3
             fprintf(fid1,'The Dominant Pollutant of Criteria AQI in Zone is:  \n\n');
     fprintf(fid1,'SO2\n\n\n');
                
                else if AQIIX==4
            fprintf(fid1,'The Dominant Pollutant of Criteria AQI in Zone is:  \n\n');
     fprintf(fid1,'O3 \n\n\n');
    
                    else 
             fprintf(fid1,'The Dominant Pollutant of Criteria AQI in Zone is:  \n\n');
     fprintf(fid1,'PM2.5 \n\n\n');
                    end;
        end;
    end;
end;
%End of Dominant criteria AQI Sellector
%*******************************************************************************************


%'+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++')
fprintf('++++++++++++++++++++++++++++++++++++BTEXHQI++++++++++++++++++++++++++++++++++++++++++');
%'+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++')

fprintf(fid1,'\n\n\n\n\n');

fprintf(fid1,'++++++++++++++++++++++++++++++BTEXHQI+++++++++++++++++++++++++++\n\n');

BTEXHQI=readfis('BTEXHQI');
figure;
plotfis(BTEXHQI);

fprintf(fid1,'Figure 3 represents the BTEXH Air Quality Index FIS  \n\n');


H2S=xlsread('data','BTEXH','B2');

Benzene=xlsread('data','BTEXH','C2');

Toluene=xlsread('data','BTEXH','D2');

EthylBenzene=xlsread('data','BTEXH','E2');

Xylene=xlsread('data','BTEXH','F2');

outBTEXHQI=evalfis([H2S Benzene Toluene EthylBenzene Xylene], BTEXHQI);
fprintf('The Calculated Fuzzy BTEXHQI =  \n');
disp(outBTEXHQI);

figure;
plotmf(BTEXHQI, 'output',1);


fprintf(fid1,'The Calculated Fuzzy BTEXHQI is =  \n\n');
fprintf(fid1,'%8.2f \n\n',outBTEXHQI);

fprintf(fid1,'Figure 4 illustrates the Membership Functions in BTEXHQI \n\n');


%Start of LOOP For: Total BTEXHQI Fuzzy LEVEL
%Analysis>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
disp(' ');
if (0<=outBTEXHQI)&&(outBTEXHQI<=50)
    fprintf(fid1,'Total level of outBTEXHQI in Zone is:  \n\n');
    fprintf(fid1,'GOOD  \n\n\n');
        disp('NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:');
sheet=2;
xlRange='J2';
A={'GOOD'};
xlswrite('data', A, sheet, xlRange);

sheet=2;
xlRange='M7';
A={'*'};
xlswrite('data', A, sheet, xlRange);

else if (50<outBTEXHQI)&&(outBTEXHQI<=100)
         fprintf(fid1,'Total level of outBTEXHQI in Zone is:  \n\n');
        fprintf(fid1,'MODERATE  \n\n\n');
            disp('NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:');
            sheet=2;
xlRange='J2';
A={'MODERATE'};
xlswrite('data', A, sheet, xlRange);

sheet=2;
xlRange='M8';
A={'*'};
xlswrite('data', A, sheet, xlRange);


    else if (100<outBTEXHQI)&&(outBTEXHQI<=150)
           fprintf(fid1,'Total level of outBTEXHQI in Zone is:  \n\n');
            fprintf(fid1,'Unhealthy For Sensetive Group  \n\n\n');
                disp('NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:');
                sheet=2;
xlRange='J2';
A={'SENSETIVE-UNHEALTHY'};
xlswrite('data', A, sheet, xlRange);

sheet=2;
xlRange='M9';
A={'*'};
xlswrite('data', A, sheet, xlRange);

                
                else if (150<outBTEXHQI)&&(outBTEXHQI<=200)
            fprintf(fid1,'Total level of outBTEXHQI in Zone is:  \n\n');
             fprintf(fid1,'Unhealthy  \n\n\n');
                disp('NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:');
                sheet=2;
xlRange='J2';
A={'UNHEALTHY'};
xlswrite('data', A, sheet, xlRange);
                

sheet=2;
xlRange='M10';
A={'*'};
xlswrite('data', A, sheet, xlRange);

                else if (200<outBTEXHQI)&&(outBTEXHQI<=300)
             fprintf(fid1,'Total level of outBTEXHQI in Zone is:  \n\n');
            fprintf(fid1,'Very Unhealthy \n\n\n');
                disp('NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:');
                sheet=2;
xlRange='J2';
A={'VERY-UNHEALTHY'};
xlswrite('data', A, sheet, xlRange);

sheet=2;
xlRange='M11';
A={'*'};
xlswrite('data', A, sheet, xlRange);


        else
            fprintf(fid1,'Total level of outBTEXHQI in Zone is:  \n\n');
            fprintf(fid1,'HAZARDOUS \n\n\n');
                disp('NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:');
                sheet=2;
xlRange='J2';
A={'HAZARDOUS'};
xlswrite('data', A, sheet, xlRange);

sheet=2;
xlRange='M12';
A={'*'};
xlswrite('data', A, sheet, xlRange);

                
                    end;
                    end;
        end;
    end;
end;
disp(' ');

%End of LOOP For: Total BTEXHQI Fuzzy LEVEL
%Analysis:<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<


% Dominant BTEXHQI Sellector
%*******************************************************************************************
Benzene1=Benzene/50;
Toluene1=Toluene/7;
EthylBenzene1=EthylBenzene/30;
Xylene1=Xylene/100;
H2S1=H2S/1000;
BTEXHQI1=[Benzene1, Toluene1, EthylBenzene1, Xylene1, H2S1];

[c, BTEXHQIIX]=max(BTEXHQI1);

if BTEXHQIIX==1
   fprintf(fid1,'The Dominant Pollutant of BTEXHQI in Zone is:  \n\n\n');
    fprintf(fid1,'Benzene');

else if BTEXHQIIX==2
       fprintf(fid1,'The Dominant Pollutant of BTEXHQI in Zone is:  \n\n\n');
    fprintf(fid1,'Toluene \n\n');
    
    else if BTEXHQIIX==3
            fprintf(fid1,'The Dominant Pollutant of BTEXHQI in Zone is:  \n\n\n');
    fprintf(fid1,'EthylBenzene \n\n');
                
                else if BTEXHQIIX==4
            fprintf(fid1,'The Dominant Pollutant of BTEXHQI in Zone is:  \n\n\n');
    fprintf(fid1,'Xylene \n\n');
    
                    else 
            fprintf(fid1,'The Dominant Pollutant of BTEXHQI in Zone is:  \n\n\n');
   fprintf(fid1,'H2S \n\n');
                    end;
        end;
    end;
end;
%End of Dominant BTEXHQI Sellector
%*******************************************************************************************

fprintf('\n');
fprintf('\n');
fprintf('\n');
fprintf('\n');
%'+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++')
fprintf('++++++++++++++++++++++++++++++++++++FAQI++++++++++++++++++++++++++++++++++++++++++');
%'+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++')

fprintf(fid1,'\n\n\n\n\n');
fprintf(fid1,'++++++++++++++++++++++++++++++FAQI+++++++++++++++++++++++++++\n\n');


fprintf('\n');
fprintf('\n');
fprintf('\n');
fprintf('\n');


FAQI=readfis('FAQI');
figure;
plotfis(FAQI);
fprintf(fid1,'Figure 5 represents the Fuzzy Air Quality Index FIS  \n\n');


outFAQI=evalfis([outAQI outBTEXHQI], FAQI);
fprintf('The Calculated FAQI =  \n');
disp(outFAQI);

figure;
plotmf(FAQI, 'output',1);

figure;
gensurf(FAQI);

fprintf(fid1,'The Calculated FAQI is=  \n\n');
fprintf(fid1,'%8.2f \n\n',outFAQI);

fprintf(fid1,'Figure 6 illustrates the Membership Functions in FAQI  \n\n');


%Start of LOOP For: Total FAQI Fuzzy LEVEL
%Analysis>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
disp(' ');
if (0<=outFAQI)&&(outFAQI<=50)
    fprintf(fid1,'Total level of outFAQI in Zone is:  \n\n');
    fprintf(fid1,'GOOD \n\n\n');
        disp('NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:');
        sheet=4;
xlRange='J2';
A={'GOOD'};
xlswrite('data', A, sheet, xlRange);

sheet=4;
xlRange='M7';
A={'*'};
xlswrite('data', A, sheet, xlRange);


else if (50<outFAQI)&&(outFAQI<=100)
        fprintf(fid1,'Total level of outFAQI in Zone is:  \n\n');
       fprintf(fid1,'MODERATE \n\n\n');
            disp('NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:');
            sheet=4;
xlRange='J2';
A={'MODERATE'};
xlswrite('data', A, sheet, xlRange);

sheet=4;
xlRange='M8';
A={'*'};
xlswrite('data', A, sheet, xlRange);


    else if (100<outFAQI)&&(outFAQI<=150)
            fprintf(fid1,'Total level of outFAQI in Zone is:  \n\n');
            fprintf(fid1,'Unhealthy For Sensetive Group \n\n\n');
                disp('NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:');
                sheet=4;
xlRange='J2';
A={'SENSETIVE-UNHEALTHY'};
xlswrite('data', A, sheet, xlRange);

sheet=4;
xlRange='M9';
A={'*'};
xlswrite('data', A, sheet, xlRange);
                
                else if (150<outFAQI)&&(outFAQI<=200)
            fprintf(fid1,'Total level of outFAQI in Zone is:  \n\n');
           fprintf(fid1,'Unhealthy \n\n\n');
                disp('NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:');
                sheet=4;
xlRange='J2';
A={'UNHEALTHY'};
xlswrite('data', A, sheet, xlRange);

sheet=4;
xlRange='M10';
A={'*'};
xlswrite('data', A, sheet, xlRange);

                
                else if (200<outFAQI)&&(outFAQI<=300)
            fprintf(fid1,'Total level of outFAQI in Zone is:  \n\n');
            fprintf(fid1,'Very Unhealthy \n\n\n');
                disp('NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:');
                sheet=4;
xlRange='J2';
A={'VERY-UNHEALTHY'};
xlswrite('data', A, sheet, xlRange);

sheet=4;
xlRange='M11';
A={'*'};
xlswrite('data', A, sheet, xlRange);


        else
            fprintf(fid1,'Total level of outFAQI in Zone is:  \n\n');
            fprintf(fid1,'HAZARDOUS  \n\n\n');
                disp('NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:');
                sheet=4;
xlRange='J2';
A={'HAZARDOUS'};
xlswrite('data', A, sheet, xlRange);

sheet=4;
xlRange='M12';
A={'*'};
xlswrite('data', A, sheet, xlRange);

                
                    end;
                    end;
        end;
    end;
end;
disp(' ');
%End of LOOP For: Total FAQI Fuzzy LEVEL
%Analysis:<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<


fprintf(fid1,'Figure 7 represents the Surface Viewe of FAQI   \n\n');


% Dominant FAQI Sellector
%*******************************************************************************************
outAQI1=outAQI/500;
outBTEXHQI1=outBTEXHQI/500;
FAQI1=[outAQI1, outBTEXHQI1];

[d, FAQIIX]=max(FAQI1);

if FAQIIX==1
   fprintf(fid1,'The Dominant Pollutant of FAQI in Zone is:  \n\n');
    fprintf(fid1,'AQI \n\n\n');
else  
        fprintf(fid1,'The Dominant Pollutant of FAQI in Zone is:  \n\n');
   fprintf(fid1,'BTEXHQI \n\n\n');
    end;
%End of Dominant FAQI Sellector
%*******************************************************************************************


fprintf('\n');
fprintf('\n');
fprintf('\n');
%'+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++')
fprintf('++++++++++++++++++++++++++++++++++++FWWQI++++++++++++++++++++++++++++++++++++++++++');
%'+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++')
fprintf(fid1,'\n\n\n\n\n');

fprintf(fid1,'++++++++++++++++++++++++++++++FWWQI+++++++++++++++++++++++++++\n\n');

fprintf('\n');
fprintf('\n');
fprintf('\n');
fprintf('\n');

FWWQI=readfis('WWQI');
figure;
plotfis(FWWQI);
fprintf(fid1,'Figure 8 represents the Fuzzy WateWater Quality Index FIS  \n\n');

fprintf('\n');
fprintf('\n');

COD=xlsread('data','wastewater','B2');

BOD=xlsread('data','wastewater','C2');

TSS=xlsread('data','wastewater','D2');

pH=xlsread('data','wastewater','E2');

PM=xlsread('data','wastewater','F2');


outFWWQI=evalfis([TSS COD BOD pH], FWWQI);
fprintf(fid1,'The Calculated Fuzzy  WWQI =  \n\n');
fprintf(fid1,'%8.2f \n\n',outFWWQI);


figure;
plotmf(FWWQI, 'output',1);
fprintf(fid1,'Figure 9 illustrates the Membership Functions in FWWQI \n\n');

%Start of LOOP For: Total FWWQI Fuzzy LEVEL
%Analysis>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
disp(' ');
if (0<=outFWWQI)&&(outFWWQI<=50)
    fprintf(fid1,'Total level of outFWWQI in Zone is:  \n\n');
     fprintf(fid1,'GOOD   \n\n\n');
        disp('NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:');
        sheet=3;
xlRange='J2';
A={'GOOD'};
xlswrite('data', A, sheet, xlRange);

sheet=3;
xlRange='M7';
A={'*'};
xlswrite('data', A, sheet, xlRange);


else if (50<outFWWQI)&&(outFWWQI<=100)
         fprintf(fid1,'Total level of outFWWQI in Zone is:  \n\n');
         fprintf(fid1,'MODERATE   \n\n\n');
            disp('NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:');
            sheet=3;
xlRange='J2';
A={'MODERATE'};
xlswrite('data', A, sheet, xlRange);

sheet=3;
xlRange='M8';
A={'*'};
xlswrite('data', A, sheet, xlRange);

   
                else if (100<outFWWQI)&&(outFWWQI<=200)
             fprintf(fid1,'Total level of outFWWQI in Zone is:  \n\n');
             fprintf(fid1,'LOW QUALITY   \n\n\n');
                disp('NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:');
                sheet=3;
xlRange='J2';
A={'LOW-QUALITY'};
xlswrite('data', A, sheet, xlRange);

sheet=3;
xlRange='M9';
A={'*'};
xlswrite('data', A, sheet, xlRange);
                
                else if (200<outFWWQI)&&(outFWWQI<=300)
            fprintf(fid1,'Total level of outFWWQI in Zone is:  \n\n');
             fprintf(fid1,'Very LOW QUALITY \n\n\n');
                disp('NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:');
                sheet=3;
xlRange='J2';
A={'VERY-LOW-QUALITY'};
xlswrite('data', A, sheet, xlRange);

sheet=3;
xlRange='M11';
A={'*'};
xlswrite('data', A, sheet, xlRange);

        else
             fprintf(fid1,'Total level of outFWWQI in Zone is:  \n\n');
             fprintf(fid1,'HAZARDOUS QUALIY  \n\n\n');
                disp('NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:');
                sheet=3;
xlRange='J2';
A={'HAZARDOUS'};
xlswrite('data', A, sheet, xlRange);

sheet=3;
xlRange='M12';
A={'*'};
xlswrite('data', A, sheet, xlRange);
                
                    end;
                    end;
    end;
end;
disp(' ');

%End of LOOP For: Total FWWQI Fuzzy LEVEL
%Analysis:<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<

%*******************************************************************************************
%Dominant FWWQI Pollutant Sellector

COD1=COD/300;
BOD1=BOD/150;
TSS1=TSS/200;

if pH>=7
    pH1=(pH-7)/7;
else pH1=(7-pH)/7;
end;

FWWQI1=[COD1, BOD1, TSS1, pH1];

[e, FWWQIIX]=max(FWWQI1);

if FWWQIIX==1
   fprintf(fid1,'The Dominant Pollutant of FWWQI in Zone is:  \n\n');
    fprintf(fid1,'COD \n\n\n');

else if FWWQIIX==2
        fprintf(fid1,'The Dominant Pollutant of FWWQI in Zone is:  \n\n');
   fprintf(fid1,'BOD \n\n\n');
    
    else if FWWQIIX==3
            fprintf(fid1,'The Dominant Pollutant of FWWQI in Zone is:  \n\n');
    fprintf(fid1,'TSS \n\n\n');
    
                    else 
            fprintf(fid1,'The Dominant Pollutant of FWWQI in Zone is:  \n\n');
    fprintf(fid1,'pH \n\n\n');
        end;
    end;
end;
%End of Dominant FWWQI Sellector
%*******************************************************************************************

fprintf('\n');
fprintf('\n');
fprintf('\n');
fprintf('\n');
fprintf(' ENVIRONMENTAL RISK = This Part Computes FUZZY ENVIRONMENTAL RISK ASSESSMENT ');
fprintf('\n');
fprintf('\n');
fprintf('\n');
fprintf('\n');
%'+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++')
fprintf('++++++++++++++++++++++++++++++++++++FERI++++++++++++++++++++++++++++++++++++++++++');
%'+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++')
fprintf(fid1,'\n\n\n\n\n');

fprintf(fid1,'++++++++++++++++++++++++++++++FERI+++++++++++++++++++++++++++\n\n');

fprintf('\n');
fprintf('\n');
fprintf('\n');
fprintf('\n');

FERI=readfis('FERI');
figure;
plotfis(FERI);
fprintf(fid1,'Figure 10 represents the Fuzzy Environmental Risk Index FIS  \n\n');


fprintf(' FERI=  Data for Qualities: FAQI and FWWQI are processed via Fuzzy Environmental Risk Index ');
fprintf('\n');
fprintf('\n');



outFERI=evalfis([outFAQI outFWWQI], FERI);
fprintf(fid1, 'The Calculated FERI =  \n');
fprintf(fid1,'%8.2f \n\n',outFERI);


figure;
plotmf(FERI, 'output',1);
fprintf(fid1,'Figure 11 illustrates the Membership Functions in FERI \n\n');


figure;
gensurf(FERI);


%Start of LOOP For: Total outFERI Fuzzy LEVEL
%Analysis>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
disp(' ');
if (0<=outFERI)&&(outFERI<=50)
    fprintf(fid1,'Total level of outFERI in Zone is:  \n\n');
    fprintf(fid1,'LOW RISK   \n\n\n');
        disp('NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:');
        sheet=5;
xlRange='J2';
A={'LOW-RISK'};
xlswrite('data', A, sheet, xlRange);

sheet=5;
xlRange='M7';
A={'*'};
xlswrite('data', A, sheet, xlRange);

else if (50<outFERI)&&(outFERI<=100)
        fprintf(fid1,'Total level of outFERI in Zone is:  \n\n');
        fprintf(fid1,'MODERATE RISK   \n\n\n');
            disp('NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:');
            sheet=5;
xlRange='J2';
A={'MODERATE-RISK'};
xlswrite('data', A, sheet, xlRange);

sheet=5;
xlRange='M8';
A={'*'};
xlswrite('data', A, sheet, xlRange);

   
                else if (100<outFERI)&&(outFERI<=200)
            fprintf(fid1,'Total level of outFERI in Zone is:  \n\n');
            fprintf(fid1,'RELATIVELY HIGH RISK   \n\n\n');
                disp('NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:');
                sheet=5;
xlRange='J2';
A={'RELEATIVELY-HIGH-RISK'};
xlswrite('data', A, sheet, xlRange);

sheet=5;
xlRange='M9';
A={'*'};
xlswrite('data', A, sheet, xlRange);
                
                else if (200<outFERI)&&(outFERI<=300)
            fprintf(fid1,'Total level of outFERI in Zone is:  \n\n');
            fprintf(fid1,'HIGH RISK \n\n\n');
                disp('NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:');
                sheet=5;
xlRange='J2';
A={'HIGH-RISK'};
xlswrite('data', A, sheet, xlRange);

sheet=5;
xlRange='M11';
A={'*'};
xlswrite('data', A, sheet, xlRange);

        else
            fprintf(fid1,'Total level of outFERI in Zone is:  \n\n');
            fprintf(fid1,'VERY HIGH RISK  \n\n\n');
                disp('NOTES:+++++++++++++++++++++++++++++++++++ACTIONS:');
                sheet=5;
xlRange='J2';
A={'VERY-HIGH-RISK'};
xlswrite('data', A, sheet, xlRange);

sheet=5;
xlRange='M12';
A={'*'};
xlswrite('data', A, sheet, xlRange);
                
                    end;
                    end;
    end;
end;
disp(' ');

%End of LOOP For: Total outFERI Fuzzy LEVEL
%Analysis:<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<




fprintf(fid1,'Figure 12 represents the Surface viewe of Fuzzy Environmental Risk Index \n\n');

% Dominant FERI Sellector
%*******************************************************************************************
outFAQI1=outFAQI/500;
outFWWQI1=outFWWQI/500;
FERI1=[outFAQI1, outFWWQI1];

[f, FERIIX]=max(FERI1);

if FERIIX==1
    fprintf(fid1,'The Dominant Pollutant of FERI in Zone is:  \n\n');
   fprintf(fid1,'FAQI  \n\n\n');
else  
        fprintf(fid1,'The Dominant Pollutant of FERI in Zone is:  \n\n');
   fprintf(fid1,'FWWQI \n\n\n');
    end;
%End of Dominant FERI Sellector
%*******************************************************************************************

sheet=1;
xlRange='I2';
xlswrite('data', outAQI, sheet, xlRange);
sheet=2;
xlRange='I2';
xlswrite('data',outBTEXHQI , sheet, xlRange);
sheet=3;
xlRange='I2';
xlswrite('data', outFWWQI, sheet, xlRange);
sheet=4;
xlRange='I2';
xlswrite('data', outFAQI, sheet, xlRange);
sheet=5;
xlRange='I2';
xlswrite('data', outFERI, sheet, xlRange);



##### SOURCE END #####
--></body></html>